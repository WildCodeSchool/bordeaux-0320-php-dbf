{% extends 'landing_base.html.twig' %}

{% block analytics %}
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-WQ7MTG');</script>
    <!-- End Google Tag Manager -->

{% endblock %}

 {% block footanalytics %}
     <!-- Google Tag Manager (noscript) -->
     <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WQ7MTG"
                       height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
     <!-- End Google Tag Manager (noscript) -->

 {% endblock %}

{% block title %}demander un rendez-vous{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    {{ encore_entry_link_tags('forms') }}
{% endblock %}

{% block navbar %}
{% endblock %}
{% block body %}
    <div class="container landingform-page">
        <div class="row">
            <div class="col s12 l6 offset-l3">
                <div class="col s12">
                    {% for type, messages in app.session.flashbag.all() %}
                        {% if type == 'landing_success' or type == 'landing_error' %}
                            {% for message in messages %}
                                <div class="col s12 landing_flash {{ type }}">
                                    <span class="white-text flash-{{ type }}">{{ message | raw }}</span>
                                </div>
                                <a class="btn btn-large light-blue mgt15" href="/dbf/form/{{ brand }}/{{ referer }}">nouvelle demande</a>
                            {% endfor %}
                        {% endif %}
                    {% endfor %}
                </div>
                {% if success == 0 %}
                {{ form_start(form) }}
                <div class="col s1 mgt15">
                    <i class="material-icons">person</i>
                </div>
                <div class="col s2 mgt15">
                    {{ form_widget(form.civility) }}
                </div>
                <div class="col s9 mgt15">
                    {{ form_widget(form.name, {'attr': {'class': (errors.name is defined) ? 'red-text upper' : 'upper' }}) }}
                    {% if errors.name is defined %}
                        <span class="textAlert red-text">{{ errors.name }}</span>
                    {% endif %}
                </div>
                <div class="col s1 mgt30">
                    <i class="material-icons">local_phone</i>
                </div>
                <div class="col s11 m7 mgt30">
                    {{ form_widget(form.phone, {'attr': {'class': (errors.phone is defined) ? 'red-text' }}) }}
                    {% if errors.phone is defined %}
                        <span class="textAlert red-text">{{ errors.phone }}</span>
                    {% endif %}
                </div>
                <div class="col s1 mgt30">
                    <i class="material-icons">directions_car</i>
                </div>
                <div class="col s11 m3 mgt30">
                    {{ form_widget(form.immatriculation, {'attr': {'class': (errors.immat is defined) ? 'red-text upper' : 'upper' }}) }}
                    {% if errors.immat is defined %}
                        <span class="textAlert red-text">{{ errors.immat }}</span>
                    {% endif %}
                </div>
                <div class="row">

                    <div class="col s12 mgt30 blue-text text-darken-4">
                        <b>Date et heure de rappel souhait√©es</b>
                    </div>
                </div>

                <div class="col s6 mgt15">
                    {{ form_widget(form.callDate, {'attr': {'class': (errors.day is defined or errors.date is defined) ? 'red-text' }}) }}
                    {% if errors.day is defined %}
                        <span class="textAlert red-text">{{ errors.day }}</span>
                    {% endif %}
                    {% if errors.date is defined %}
                        <span class="textAlert red-text">{{ errors.date }}</span>
                    {% endif %}
                </div>
                <div class="col l1 mgt15 hide-on-med-and-down">
                    <i class="material-icons">access_time</i>
                </div>
                <div class="col l2 s3 mgt15">
                    {{ form_widget(form.callHour) }}
                </div>
                <div class="col l2 s3 mgt15">
                    {{ form_widget(form.callMinutes) }}
                </div>


                    <div class="row">
                        <div class="col s12 mgt30 blue-text text-darken-4">
                            <b>Choississez une ville et concession</b>
                        </div>
                    </div>
                <div class="col s1 mgt15 {% if brand is null %}hide{% endif %}">
                    <span><i class="material-icons">location_on</i></span>
                </div>
                <div class="col s11 mgt15 {% if brand is null %}hide{% endif %}">
                    {{ form_widget(form.place) }}
                </div>

                    <div class="row">
                        <div class="col s1 mgt30">

                        </div>
                        <div class="col s11 mgt30 blue-text text-darken-4">
                            <b>Type d'intervention</b>
                        </div>
                    </div>

                <div class="col s1 mgt15 {% if brand is null %}hide{% endif %}">
                    <span><i class="material-icons">build</i></span>
                </div>
                <div class="col s11 mgt15 {% if brand is null %}hide{% endif %}">
                    {{ form_widget(form.askFor) }}
                </div>


                <div class="col s1 mgt30 {% if brand is null %}hide{% endif %}">
<<<<<<< HEAD
                    <span><i class="material-icons">message</i></span><bR>
=======
                    <span><i class="material-icons">message</i></span><br>
>>>>>>> easyauto/april2021
                </div>
                <div class="col s11 mgt30 {% if brand is null %}hide{% endif %}">
                    {{ form_widget(form.message) }}
                </div>

                <div class="col s12 mgt15 center-align">
                    <button class="btn btn-large green {% if brand is null %}hide{% endif %}" style="width:100%;"
                            id="submit_landing_form_apv">{{ button_label|default('envoyer') }}</button>
                </div>
                <div class="col s12  hide mgt15" id="landing_loader">
                    <div class="progress grey lighten-3">
                        <div class="indeterminate green"></div>
                    </div>
                </div>
                {{ form_end(form) }}
                {% endif %}

            </div>

        </div>

    </div>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const origin = window.parent.location
        console.log(origin)
        if (!document.getElementById('dbf_origin').value || document.getElementById('dbf_origin').value == '') {
            document.getElementById('dbf_origin').setAttribute('value', origin.href)
        }
    })

</script>
{% endblock %}
